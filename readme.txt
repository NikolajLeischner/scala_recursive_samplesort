This code shows the key steps of randomized sample sort. It is meant to be intelligible & concise. Foremost, the code does not care about memory management. An efficient implementation would allocate two buffers of the size of the input, and re-use these during the distribution steps. 

Also refer to e.g.: algo2.iti.kit.edu/sanders/papers/ssss.ps.gz